#!/bin/bash

TIMEOUT=15

echo "Waiting for mysql"

COUNT=1

until mysql -h mysqldb -P 3306 -uroot --password=secret &> /dev/null
do
  printf "."
  if [[ $COUNT -gt $TIMEOUT ]]; then
      echo -e "\n*** Connection timed out ***"
      exit 1
      break
  fi
  sleep 1
  COUNT=$((COUNT + 1))
done

echo -e "\nmysql is ready"
